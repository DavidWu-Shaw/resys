@using Nop.Web.Areas.Admin.Models.Self
@model AppointmentEditModel
@{
    Layout = "_AdminPopupLayout";
}

<form asp-controller="Product" asp-action="Edit" method="post" id="product-form">
    <div class="panel-body">
        <div class="form-group">
            <div class="col-sm-5">
                <nop-label asp-for="TimeSlot" />
            </div>
            <div class="col-sm-7">
                <div class="form-text-row">@Model.TimeSlot</div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-5">
                <nop-label asp-for="Status" />
            </div>
            <div class="col-sm-7">
                <div class="form-text-row">@Model.Status</div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-5">
                <nop-label asp-for="CustomerId" />
            </div>
            <div class="col-sm-7">
                <a asp-controller="Customer" asp-action="Edit" asp-route-id="@Model.CustomerId">@Model.CustomerEmail</a>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-5">
                <nop-label asp-for="CustomerFullName" />
            </div>
            <div class="col-sm-7">
                <div class="form-text-row">@Model.CustomerFullName</div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-5">
                <nop-label asp-for="Notes" />
            </div>
            <div class="col-sm-7">
                <nop-textarea asp-for="@Model.Notes" disabled></nop-textarea>
            </div>
        </div>
        @if (Model.IsLoggedInAsVendor)
        {
            <div class="form-group">
                <div class="col-sm-7 col-sm-offset-5">
                    @if (Model.CanConfirm)
                    {
                        <button type="submit" name="btnConfirmAppointment" id="btnConfirmAppointment" class="btn btn-primary" style="margin-right: 3px;">
                            @T("Admin.AppointmentEdit.Confirm")
                        </button>
                    }
                    @if (Model.CanCancel)
                    {
                        <button type="submit" name="btnCancelAppointment" id="btnCancelAppointment" class="btn bg-red" style="margin-right: 3px;">
                            @T("Admin.AppointmentEdit.Cancel")
                        </button>
                        <nop-action-confirmation asp-button-id="btnCancelAppointment" />
                    }
                    @if (Model.CanDelete)
                    {
                        <button type="submit" name="btnDeleteAppointment" id="btnDeleteAppointment" class="btn bg-red" style="margin-right: 3px;">
                            @T("Admin.AppointmentEdit.Delete")
                        </button>
                        <nop-action-confirmation asp-button-id="btnDeleteAppointment" />
                    }
                    <button type="submit" name="btnCloseAppointmentEdit" id="btnCloseAppointmentEdit" class="btn bg-teal">
                        @T("Admin.Common.Close")
                    </button>
                </div>
            </div>
        }
    </div>
</form>
<script type="text/javascript">
    $(document).ready(function () {
        $("#btnCloseAppointmentEdit").click(function () {
            modal.close();
            return false;
        });

        $("#btnConfirmAppointment").click(function () {
            var params = {
                id: @Model.Id
            };
            addAntiForgeryToken(params);
            console.log(params);
            $.ajax({
                url: "@Url.Action("AppointmentConfirm", "Product")",
                type: "post",
                datatype: "json",
                data: params,
                cache: false
            }).done(function (result) {
                console.log("result=", result);
                modal.close(result);
            }).fail(function (result) {
                // Error
                console.log("fail result=", result);
                });
            return false;
        });

        $("#btnCancelAppointment").click(function () {
            var params = {
                id: @Model.Id
            };
            addAntiForgeryToken(params);
            console.log(params);
            $.ajax({
                url: "@Url.Action("AppointmentCancel", "Product")",
                type: "post",
                datatype: "json",
                data: params,
                cache: false
            })
            .done(function (result) {
                console.log("result=", result);
                modal.close(result);
            })
            .fail(function (result) {
                // Error
                console.log("fail result=", result);
            });
            return false;
        });

        $("#btnDeleteAppointment").click(function () {
            var params = {
                id: @Model.Id
            };
            addAntiForgeryToken(params);
            console.log(params);
            $.ajax({
                url: "@Url.Action("AppointmentDelete", "Product")",
                type: "post",
                datatype: "json",
                data: params,
                cache: false
            })
            .done(function (result) {
                console.log("result=", result);
                modal.close(result);
            })
            .fail(function (result) {
                // Error
                console.log("fail result=", result);
            });
            return false;
        });
    });
</script>